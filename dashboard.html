<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-zh="ç³»ç»Ÿä»ªè¡¨æ¿" data-en="System Dashboard">ç³»ç»Ÿä»ªè¡¨æ¿</title>
    <link rel="stylesheet" href="assets/css/common.css">
    <link rel="stylesheet" href="assets/css/navbar.css">
    <style>
        /* ä»ªè¡¨ç›˜ç‰¹å®šæ ·å¼ */

        /* å¸ƒå±€ç³»ç»Ÿ - ä¸ç”¨æˆ·ç®¡ç†é¡µé¢ä¿æŒä¸€è‡´ */
        .content-layout {
            display: flex;
            max-width: 1600px;
            margin: 0 auto;
            padding: var(--space-12) var(--space-8);
            gap: var(--space-6);
        }

        .main-container {
            flex: 1;
            min-width: 0;
            padding-top: 0;
        }

        /* æœç´¢åŒºåŸŸæ ·å¼ - ç”¨ä½œæ ‡é¢˜åŒºåŸŸ */
        .search-section {
            background: var(--background);
            border: var(--border);
            border-radius: var(--radius);
            padding: var(--space-6);
            margin-bottom: var(--space-6);
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: var(--space-4);
        }

        .search-controls h3 {
            margin: 0;
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .search-actions {
            display: flex;
            gap: var(--space-3);
        }

        /* è¡¨æ ¼å®¹å™¨æ ·å¼ - ç”¨ä½œå†…å®¹åŒºåŸŸ */
        .table-container {
            background: var(--background);
            border: var(--border);
            border-radius: var(--radius);
            overflow: hidden;
            margin-bottom: var(--space-6);
        }

        /* å¿«é€ŸæŒ‡å¼•æ¨¡å— - ä¸è´¦å•ç®¡ç†é¡µé¢é£æ ¼ä¸€è‡´ */
        #workflowGuide {
            background: var(--background);
            border: var(--border);
            border-radius: var(--radius);
        }

        .workflow-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--space-6) var(--space-6) 0 var(--space-6);
            background: var(--background);
        }

        .workflow-header-content h3 {
            color: var(--text-primary);
            font-size: 18px;
            font-weight: var(--font-weight-semibold);
            margin: 0 0 var(--space-1) 0;
        }

        .workflow-header-content p {
            color: var(--text-secondary);
            font-size: 14px;
            margin: 0;
        }

        .workflow-header-actions {
            display: flex;
            align-items: center;
        }

        /* æç®€å›¾æ ‡æŒ‰é’® */
        .workflow-toggle-icon {
            background: none;
            border: none;
            color: var(--text-secondary);
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius);
            transition: all 0.15s ease;
            cursor: pointer;
        }

        .workflow-toggle-icon:hover {
            background: var(--surface);
            color: var(--text-primary);
        }

        .workflow-toggle-icon svg {
            transition: transform 0.15s ease;
        }

        /* é»˜è®¤å±•å¼€çŠ¶æ€ï¼šç®­å¤´å‘ä¸‹ */
        .workflow-toggle-icon svg {
            transform: rotate(0deg);
        }

        /* æ”¶èµ·çŠ¶æ€ï¼šç®­å¤´å‘å³ */
        .workflow-toggle-icon.collapsed svg {
            transform: rotate(-90deg);
        }

        /* æŒ‡æ ‡å¡ç‰‡ç½‘æ ¼ */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--space-6);
            margin-bottom: var(--space-8);
        }

        .metric-card {
            background: var(--background);
            border: var(--border);
            border-radius: var(--radius);
            padding: var(--space-6);
            transition: all 0.15s ease;
            display: flex;
            align-items: center;
            gap: var(--space-4);
            text-decoration: none;
            color: inherit;
            box-shadow: var(--shadow);
        }

        .metric-card:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-hover);
        }

        /* å·¥ä½œæµç¨‹å®¹å™¨ - é“ºæ»¡å…¨å± */
        .workflow-container {
            padding: var(--space-8) var(--space-6);
            background: linear-gradient(135deg, var(--background) 0%, var(--surface) 100%);
        }

        /* æµç¨‹æ­¥éª¤å¸ƒå±€ - ä¼˜åŒ–ä¸ºå…¨å±å¸ƒå±€ */
        .workflow-flow {
            display: flex;
            align-items: stretch;
            justify-content: space-between;
            gap: var(--space-6);
            margin: 0;
            max-width: 100%;
        }

        /* æ­¥éª¤é¡¹ - ä¼˜åŒ–å°ºå¯¸å’Œè®¾è®¡ */
        .workflow-step-item {
            background: var(--background);
            border: var(--border);
            border-radius: var(--radius);
            padding: var(--space-6) var(--space-4);
            transition: all 0.2s ease;
            text-align: center;
            flex: 1;
            position: relative;
            cursor: pointer;
            box-shadow: var(--shadow);
            min-height: 180px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .workflow-step-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
            border-color: var(--primary);
        }

        /* æ­¥éª¤æ•°å­— - å¢å¤§å°ºå¯¸ */
        .step-number {
            width: 48px;
            height: 48px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: var(--font-weight-bold);
            font-size: 20px;
            margin: 0 auto var(--space-4) auto;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        /* æ­¥éª¤å†…å®¹ - ä¼˜åŒ–å¸ƒå±€ */
        .step-content {
            display: flex;
            flex-direction: column;
            gap: var(--space-3);
            flex: 1;
        }

        .step-title {
            font-size: 16px;
            font-weight: var(--font-weight-semibold);
            color: var(--text-primary);
            line-height: 1.3;
        }

        .step-desc {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.4;
            flex: 1;
        }

        /* è¿æ¥çº¿ - ä¼˜åŒ–è®¾è®¡ */
        .step-connector {
            color: var(--primary);
            font-size: 24px;
            font-weight: bold;
            margin: 0 var(--space-3);
            align-self: center;
            opacity: 0.6;
        }

        /* æŒ‰é’®ä¼˜åŒ– */
        .workflow-step-item .btn-primary {
            margin-top: auto;
            width: 100%;
            padding: var(--space-3) var(--space-4);
            font-weight: var(--font-weight-medium);
        }

        /* å®ŒæˆçŠ¶æ€ - ä¼˜åŒ–è§†è§‰æ•ˆæœ */
        .workflow-step-item.completed {
            background: linear-gradient(135deg, var(--success) 0%, #38a169 100%);
            border-color: var(--success);
            color: white;
        }

        .workflow-step-item.completed .step-number {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .workflow-step-item.completed .step-title,
        .workflow-step-item.completed .step-desc {
            color: white;
        }

        .workflow-step-item.completed .btn-primary {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
        }

        .workflow-step-item.completed .btn-primary:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* æ·»åŠ è¿›åº¦æŒ‡ç¤ºå™¨ */
        .workflow-progress-bar {
            position: absolute;
            top: 24px;
            left: 24px;
            right: 24px;
            height: 2px;
            background: var(--divider);
            border-radius: 1px;
            overflow: hidden;
        }

        .workflow-progress-fill {
            height: 100%;
            background: var(--primary);
            width: 0%;
            transition: width 0.3s ease;
        }

        /* ç»Ÿè®¡æ¨¡å—å®¹å™¨ - 50/50 å¸ƒå±€ */
        .stats-modules-container {
            display: flex;
            gap: var(--space-6);
            margin-bottom: var(--space-6);
        }

        .stats-module {
            flex: 1;
        }

        /* è®¾å¤‡ç»Ÿè®¡æ ·å¼ */
        .device-stats {
            padding: var(--space-6);
            display: flex;
            flex-direction: column;
            gap: var(--space-6);
        }

        .device-chart-container {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #deviceChart {
            max-width: 150px;
            max-height: 150px;
        }

        .device-summary {
            position: absolute;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .total-devices {
            text-align: center;
        }

        .total-number {
            display: block;
            font-size: 24px;
            font-weight: var(--font-weight-bold);
            color: var(--text-primary);
            line-height: 1;
        }

        .total-label {
            display: block;
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: var(--space-1);
        }

        /* å›¾ä¾‹æ ·å¼ */
        .device-legend {
            display: flex;
            justify-content: center;
            gap: var(--space-6);
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .online-color {
            background-color: var(--success);
        }

        .offline-color {
            background-color: var(--error);
        }

        .legend-text {
            text-align: left;
        }

        .legend-value {
            font-size: 16px;
            font-weight: var(--font-weight-semibold);
            color: var(--text-primary);
            line-height: 1;
        }

        .legend-label {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 2px;
        }

        /* è´¦å•ç»Ÿè®¡æ ·å¼ */
        .bill-stats {
            padding: var(--space-6);
        }

        /* ç®€åŒ–çš„è´¦å•ç»Ÿè®¡å¸ƒå±€ */
        .simple-stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-6);
        }

        .stats-column {
            display: flex;
            flex-direction: column;
            gap: var(--space-4);
        }

        .column-title {
            font-size: 16px;
            font-weight: var(--font-weight-semibold);
            color: var(--text-primary);
            margin: 0;
            padding-bottom: var(--space-2);
            border-bottom: 2px solid var(--divider);
            text-align: center;
        }

        .stats-column .stat-item {
            text-align: center;
            padding: var(--space-4);
            background: var(--surface);
            border-radius: var(--radius);
            border: var(--border);
        }

        .stat-value.primary {
            color: var(--primary);
            font-size: 20px;
            font-weight: var(--font-weight-bold);
            margin-bottom: var(--space-2);
        }

        .stat-value.secondary {
            color: var(--text-secondary);
            font-size: 20px;
            font-weight: var(--font-weight-bold);
            margin-bottom: var(--space-2);
        }

        /* æœ¬æœˆæ•°æ®ç‰¹æ®Šæ ·å¼ */
        .stats-column:first-child .column-title {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        /* ä¸Šæœˆæ•°æ®ç‰¹æ®Šæ ·å¼ */
        .stats-column:nth-child(2) .column-title {
            color: var(--text-secondary);
            border-bottom-color: var(--text-secondary);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--space-4);
        }

        .stat-item {
            text-align: center;
            padding: var(--space-3);
            background: var(--surface);
            border-radius: var(--radius);
            border: var(--border);
        }

        .stat-value {
            font-size: 20px;
            font-weight: var(--font-weight-semibold);
            color: var(--text-primary);
            margin-bottom: var(--space-1);
        }

        .stat-value.online {
            color: var(--success);
        }

        .stat-value.offline {
            color: var(--error);
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: var(--space-1);
        }

        .stat-change {
            font-size: 11px;
            font-weight: var(--font-weight-medium);
        }

        .stat-change.positive {
            color: var(--success);
        }

        .metric-card .metric-icon {
            width: 48px;
            height: 48px;
            border-radius: var(--radius);
            background: var(--surface);
            border: var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            flex-shrink: 0;
            color: var(--text-secondary);
        }

        .metric-content {
            flex: 1;
        }

        .metric-value {
            font-size: 16px;
            font-weight: var(--font-weight-semibold);
            color: var(--text-primary);
            margin-bottom: var(--space-2);
            line-height: 1.2;
        }

        .metric-label {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: var(--space-3);
            font-weight: var(--font-weight-normal);
        }

        .metric-change {
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: var(--space-2);
            font-weight: var(--font-weight-medium);
        }

        .metric-change.positive {
            color: var(--success);
        }

        .metric-change.positive::before {
            content: 'â†—';
            font-size: 14px;
        }

        .metric-change.negative {
            color: var(--error);
        }

        .metric-change.negative::before {
            content: 'â†˜';
            font-size: 14px;
        }

        /* æœ€è¿‘æ´»åŠ¨æ ·å¼ */
        .recent-activity {
            background: var(--background);
            border: var(--border);
            border-radius: var(--radius);
            padding: var(--space-6);
        }

        .recent-activity h3 {
            margin: 0 0 var(--space-6) 0;
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .activity-list {
            display: flex;
            flex-direction: column;
            gap: var(--space-4);
        }

        .activity-item {
            display: flex;
            align-items: flex-start;
            gap: var(--space-3);
            padding: var(--space-4);
            background: var(--surface);
            border-radius: var(--radius);
            transition: all 0.2s ease;
        }

        .activity-item:hover {
            background: var(--hover);
        }

        .activity-icon {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
            flex-shrink: 0;
            color: white;
        }

        .activity-icon.success {
            background: var(--success);
        }

        .activity-icon.warning {
            background: var(--warning);
        }

        .activity-icon.info {
            background: var(--info);
        }

        .activity-content {
            flex: 1;
        }

        .activity-content p {
            margin: 0 0 var(--space-1) 0;
            font-size: 14px;
            line-height: 1.4;
        }

        .activity-content strong {
            color: var(--text-primary);
        }

        .activity-time {
            font-size: 12px;
            color: var(--text-tertiary);
        }

        /* æŒ‰é’®æ ·å¼ - ä¸ç”¨æˆ·ç®¡ç†é¡µé¢ä¿æŒä¸€è‡´ */
        .btn {
            padding: var(--space-2) var(--space-4);
            border: none;
            border-radius: var(--radius);
            font-family: inherit;
            font-size: 14px;
            font-weight: var(--font-weight-medium);
            cursor: pointer;
            transition: all 0.15s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-2);
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-hover);
        }

        .btn-secondary {
            background: var(--surface);
            color: var(--text-primary);
            border: var(--border);
        }

        .btn-secondary:hover {
            background: var(--divider);
        }

        .btn-sm {
            padding: 4px 8px;
            font-size: 12px;
        }

        /* å·¥ä½œæµç¨‹å¯¹è¯æ¡†æ ·å¼ */
        .workflow-dialog-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .workflow-dialog {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow-elevated);
            max-width: 480px;
            width: 90%;
            animation: slideIn 0.3s ease;
        }

        .dialog-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-6);
            border-bottom: var(--border);
        }

        .dialog-header h3 {
            color: var(--text-primary);
            font-size: 20px;
            font-weight: var(--font-weight-semibold);
            margin: 0;
        }

        .dialog-close {
            background: none;
            border: none;
            font-size: 24px;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .dialog-content {
            padding: var(--space-6);
        }

        .dialog-content p {
            color: var(--text-secondary);
            line-height: 1.6;
            margin: 0;
        }

        .dialog-actions {
            display: flex;
            gap: var(--space-3);
            padding: var(--space-6);
            border-top: var(--border);
            justify-content: flex-end;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* é¡µé¢èƒŒæ™¯ - ç®€åŒ–ç‰ˆæœ¬ */
        body {
            background: var(--background-page);
        }

        .main-content {
            position: relative;
        }

        /* æœç´¢åŒºåŸŸæ ‡é¢˜ */
        .search-section h3 {
            color: var(--text-primary);
            font-weight: var(--font-weight-semibold);
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1200px) {
            .content-layout {
                flex-direction: column;
            }

            .stats-modules-container {
                flex-direction: column;
                gap: var(--space-4);
            }
        }

        @media (max-width: 768px) {
            .content-layout {
                padding: var(--space-8) var(--space-4);
            }

            .search-section {
                flex-direction: column;
                align-items: stretch;
            }

            .workflow-container {
                padding: var(--space-6) var(--space-4);
            }

            .workflow-flow {
                flex-direction: column;
                gap: var(--space-4);
                align-items: stretch;
            }

            .step-connector {
                transform: rotate(90deg);
                margin: var(--space-3) 0;
                font-size: 20px;
            }

            .workflow-step-item {
                min-width: auto;
                width: 100%;
                min-height: 140px;
                padding: var(--space-4);
            }

            .step-number {
                width: 40px;
                height: 40px;
                font-size: 18px;
                margin-bottom: var(--space-3);
            }

            .step-title {
                font-size: 15px;
            }

            .step-desc {
                font-size: 13px;
            }

            .stats-grid {
                grid-template-columns: 1fr;
                gap: var(--space-3);
            }

            .simple-stats-grid {
                grid-template-columns: 1fr;
                gap: var(--space-4);
            }

            .stats-column .stat-item {
                padding: var(--space-3);
            }

            .stat-value.primary,
            .stat-value.secondary {
                font-size: 18px;
            }

            .workflow-dialog {
                margin: var(--space-4);
                width: calc(100% - 32px);
            }

            .nav-menu {
                gap: 10px !important;
            }
        }
    </style>
</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-brand">
                <img src="logo.png" alt="Logo" class="nav-logo">
            </div>
            <div class="nav-menu">
                <a href="dashboard.html" class="nav-link active" data-zh="ä»ªè¡¨ç›˜" data-en="Dashboard">ä»ªè¡¨ç›˜</a>
                <a href="device-management.html" class="nav-link" data-zh="è®¾å¤‡ç®¡ç†" data-en="Device Management">è®¾å¤‡ç®¡ç†</a>
                <a href="space-management.html" class="nav-link" data-zh="å»ºç­‘ç®¡ç†" data-en="Building Management">å»ºç­‘ç®¡ç†</a>
                <a href="user-management.html" class="nav-link" data-zh="ç”¨æˆ·ç®¡ç†" data-en="User Management">ç”¨æˆ·ç®¡ç†</a>
                <a href="bills.html" class="nav-link" data-zh="è´¦å•ç®¡ç†" data-en="Bill Management">è´¦å•ç®¡ç†</a>
            </div>
            <div class="nav-actions" style="overflow: visible !important;">
                <div class="lang-dropdown">
                    <select id="language-select" class="form-select lang-select">
                        <option value="zh" data-zh="ä¸­æ–‡" data-en="Chinese">ä¸­æ–‡</option>
                        <option value="en" data-zh="English" data-en="English">English</option>
                    </select>
                </div>
                <div class="user-menu" style="position: relative; overflow: visible !important;">
                    <input type="checkbox" id="user-dropdown-toggle" style="display: none;">
                    <label for="user-dropdown-toggle" style="display: flex; align-items: center; cursor: pointer; gap: 8px;">
                        <div class="user-avatar">ç®¡</div>
                        <span data-zh="ç®¡ç†å‘˜" data-en="Admin">ç®¡ç†å‘˜</span>
                        <span style="font-size: 12px; margin-left: 4px;">â–¼</span>
                    </label>

                    <!-- ä¸‹æ‹‰èœå• -->
                    <div class="dropdown-menu" style="position: fixed; top: 64px; right: 20px; background: white; border: 1px solid #e5e7eb; border-radius: 8px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); min-width: 120px; display: none; z-index: 9999; padding: 4px 0;">
                        <label for="logout-confirm-toggle" style="display: flex; align-items: center; padding: 12px 16px; text-decoration: none; color: #dc2626; font-size: 14px; transition: background-color 0.15s ease; gap: 8px; cursor: pointer;">
                            <span style="font-size: 16px;">ğŸšª</span>
                            <span data-zh="é€€å‡ºç™»å½•" data-en="Logout">é€€å‡ºç™»å½•</span>
                        </label>
                    </div>
                </div>

                <style>
                    .navbar, .nav-content, .nav-actions, .user-menu {
                        overflow: visible !important;
                    }

                    #user-dropdown-toggle:checked + label + .dropdown-menu {
                        display: block !important;
                        animation: dropdownFadeIn 0.2s ease-out;
                    }

                    #user-dropdown-toggle:checked + label span:last-child {
                        transform: rotate(180deg);
                        transition: transform 0.2s ease;
                    }

                    .dropdown-menu label:hover {
                        background-color: #f9fafb !important;
                    }

                    @keyframes dropdownFadeIn {
                        from {
                            opacity: 0;
                            transform: translateY(-10px);
                        }
                        to {
                            opacity: 1;
                            transform: translateY(0);
                        }
                    }

                    /* é€€å‡ºç¡®è®¤å¼¹çª—æ ·å¼ */
                    #logout-confirm-toggle:checked + .logout-modal {
                        display: flex !important;
                        animation: modalFadeIn 0.3s ease-out;
                    }

                    #logout-confirm-toggle:checked + .logout-modal > div {
                        transform: scale(1) !important;
                        animation: modalSlideIn 0.3s ease-out;
                    }

                    @keyframes modalFadeIn {
                        from { opacity: 0; }
                        to { opacity: 1; }
                    }

                    @keyframes modalSlideIn {
                        from {
                            transform: scale(0.8) translateY(-20px);
                            opacity: 0;
                        }
                        to {
                            transform: scale(1) translateY(0);
                            opacity: 1;
                        }
                    }

                    .logout-modal label:hover {
                        background-color: #e5e7eb !important;
                    }

                    .logout-modal a:hover {
                        background-color: #b91c1c !important;
                    }
                </style>
            </div>
        </div>
    </nav>

    <!-- é€€å‡ºç¡®è®¤å¼¹çª— -->
    <input type="checkbox" id="logout-confirm-toggle" style="display: none;">
    <div class="logout-modal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); display: none; z-index: 99999; align-items: center; justify-content: center; backdrop-filter: blur(4px);">
        <div style="background: white; border-radius: 12px; padding: 32px; max-width: 420px; width: 90%; box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3); transform: scale(0.9); transition: transform 0.2s ease;">
            <div style="text-align: center; font-size: 48px; margin-bottom: 20px;">âš ï¸</div>
            <h3 style="text-align: center; font-size: 20px; font-weight: 600; color: #1f2937; margin-bottom: 12px; margin-top: 0;" data-zh="ç¡®è®¤é€€å‡º" data-en="Confirm Logout">ç¡®è®¤é€€å‡º</h3>
            <p style="text-align: center; color: #6b7280; font-size: 16px; line-height: 1.5; margin-bottom: 28px; margin-top: 0;" data-zh="æ‚¨ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿé€€å‡ºåéœ€è¦é‡æ–°è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ã€‚" data-en="Are you sure you want to logout? You will need to enter your username and password again.">æ‚¨ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿé€€å‡ºåéœ€è¦é‡æ–°è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ã€‚</p>
            <div style="display: flex; gap: 12px; justify-content: center;">
                <label for="logout-confirm-toggle" style="padding: 12px 24px; background: #f3f4f6; color: #374151; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 500; text-align: center; transition: background-color 0.2s ease; min-width: 80px;" data-zh="å–æ¶ˆ" data-en="Cancel">å–æ¶ˆ</label>
                <a href="index.html" style="padding: 12px 24px; background: #dc2626; color: white; border-radius: 8px; text-decoration: none; font-size: 14px; font-weight: 500; text-align: center; transition: background-color 0.2s ease; min-width: 80px; display: block;" data-zh="ç¡®è®¤é€€å‡º" data-en="Confirm">ç¡®è®¤é€€å‡º</a>
            </div>
        </div>
    </div>

    <!-- ä¸»å†…å®¹åŒºåŸŸ -->
    <main class="main-content">
        <div class="content-layout">
            <div class="main-container">

                <!-- å¿«é€Ÿå…¥é—¨æŒ‡å¼• -->
                <div class="table-container" id="workflowGuide">
                    <div class="workflow-header">
                        <div class="workflow-header-content">
                            <h3 data-zh="å¿«é€Ÿå…¥é—¨æŒ‡å¼•" data-en="Quick Start Guide">å¿«é€Ÿå…¥é—¨æŒ‡å¼•</h3>
                            <p data-zh="ç”¨æˆ·å¯ä»¥è‡ªå·±ç‚¹å‡»å¯¹åº”çš„æ­¥éª¤" data-en="Users can click on the corresponding steps themselves">ç”¨æˆ·å¯ä»¥è‡ªå·±ç‚¹å‡»å¯¹åº”çš„æ­¥éª¤</p>
                        </div>
                        <div class="workflow-header-actions">
                            <button class="workflow-toggle-icon" onclick="toggleWorkflowGuide()" title="æ”¶èµ·æŒ‡å¼•">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                    <path d="M8 12L3 7H13L8 12Z" fill="currentColor"/>
                                </svg>
                            </button>
                        </div>
                    </div>

                    <div class="workflow-container" id="workflowSteps">
                        <!-- è¿›åº¦æ¡ -->
                        <div class="workflow-progress-bar">
                            <div class="workflow-progress-fill" id="workflow-progress"></div>
                        </div>

                        <!-- æµç¨‹æ­¥éª¤ -->
                        <div class="workflow-flow">
                            <div class="workflow-step-item" data-step="1" onclick="startDevice()">
                                <div class="step-number">1</div>
                                <div class="step-content">
                                    <div class="step-title" data-zh="æ·»åŠ è®¾å¤‡" data-en="Add Device">æ·»åŠ è®¾å¤‡</div>
                                    <div class="step-desc" data-zh="æ³¨å†Œç”µè¡¨è®¾å¤‡" data-en="Register meter devices">æ³¨å†Œç”µè¡¨è®¾å¤‡</div>
                                    <button class="btn btn-primary" data-zh="å¼€å§‹æ·»åŠ " data-en="Start Adding">å¼€å§‹æ·»åŠ </button>
                                </div>
                            </div>
                            <div class="step-connector">â†’</div>

                            <div class="workflow-step-item" data-step="2" onclick="startSpace()">
                                <div class="step-number">2</div>
                                <div class="step-content">
                                    <div class="step-title" data-zh="åˆ›å»ºå»ºç­‘" data-en="Create Building">åˆ›å»ºå»ºç­‘</div>
                                    <div class="step-desc" data-zh="æ·»åŠ å»ºç­‘ç‰©ï¼Œç»‘å®šç”µè¡¨" data-en="Add buildings and bind meters">æ·»åŠ å»ºç­‘ç‰©ï¼Œç»‘å®šç”µè¡¨</div>
                                    <button class="btn btn-primary" data-zh="å¼€å§‹åˆ›å»º" data-en="Start Creating">å¼€å§‹åˆ›å»º</button>
                                </div>
                            </div>
                            <div class="step-connector">â†’</div>

                            <div class="workflow-step-item" data-step="3" onclick="startUser()">
                                <div class="step-number">3</div>
                                <div class="step-content">
                                    <div class="step-title" data-zh="æ·»åŠ ç”¨æˆ·" data-en="Add User">æ·»åŠ ç”¨æˆ·</div>
                                    <div class="step-desc" data-zh="åˆ›å»ºç”¨æˆ·è´¦å·å¹¶å…¥é©»æˆ¿é—´" data-en="Create user accounts and assign rooms">åˆ›å»ºç”¨æˆ·è´¦å·å¹¶å…¥é©»æˆ¿é—´</div>
                                    <button class="btn btn-primary" data-zh="å¼€å§‹æ·»åŠ " data-en="Start Adding">å¼€å§‹æ·»åŠ </button>
                                </div>
                            </div>
                            <div class="step-connector">â†’</div>

                            <div class="workflow-step-item" data-step="4" onclick="startTemplate()">
                                <div class="step-number">4</div>
                                <div class="step-content">
                                    <div class="step-title" data-zh="æŸ¥çœ‹è´¦å•" data-en="View Bills">æŸ¥çœ‹è´¦å•</div>
                                    <div class="step-desc" data-zh="è®¾ç½®ç”µè´¹è®¡ç®—è§„åˆ™å’Œä»·æ ¼ç»“æ„" data-en="Set up billing rules and pricing structure">è®¾ç½®ç”µè´¹è®¡ç®—è§„åˆ™å’Œä»·æ ¼ç»“æ„</div>
                                    <button class="btn btn-primary" data-zh="å¼€å§‹åˆ›å»º" data-en="Start Creating">å¼€å§‹åˆ›å»º</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ç»Ÿè®¡æ¨¡å—å®¹å™¨ - 50/50å¸ƒå±€ -->
                <div class="stats-modules-container">
                    <!-- è´¦å•ç»Ÿè®¡æ¨¡å— -->
                    <div class="table-container stats-module">
                        <div class="search-section">
                            <div class="search-controls">
                                <h3 data-zh="è´¦å•ç»Ÿè®¡" data-en="Bill Statistics">è´¦å•ç»Ÿè®¡</h3>
                            </div>
                        </div>
                        <div class="bill-stats">
                            <div class="simple-stats-grid">
                                <!-- æœ¬æœˆæ•°æ® -->
                                <div class="stats-column">
                                    <h4 class="column-title" data-zh="æœ¬æœˆ" data-en="This Month">æœ¬æœˆ</h4>
                                    <div class="stat-item">
                                        <div class="stat-value primary">12</div>
                                        <div class="stat-label" data-zh="è´¦å•æ•°é‡" data-en="Bills">è´¦å•æ•°é‡</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value primary">1,248</div>
                                        <div class="stat-label" data-zh="ç”¨ç”µé‡(kWh)" data-en="Usage(kWh)">ç”¨ç”µé‡(kWh)</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value primary">â‚¹18,720</div>
                                        <div class="stat-label" data-zh="è´¦å•é‡‘é¢" data-en="Bills">è´¦å•é‡‘é¢</div>
                                    </div>
                                </div>

                                <!-- ä¸Šæœˆæ•°æ® -->
                                <div class="stats-column">
                                    <h4 class="column-title" data-zh="ä¸Šæœˆ" data-en="Last Month">ä¸Šæœˆ</h4>
                                    <div class="stat-item">
                                        <div class="stat-value secondary">11</div>
                                        <div class="stat-label" data-zh="è´¦å•æ•°é‡" data-en="Bills">è´¦å•æ•°é‡</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value secondary">1,156</div>
                                        <div class="stat-label" data-zh="ç”¨ç”µé‡(kWh)" data-en="Usage(kWh)">ç”¨ç”µé‡(kWh)</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value secondary">â‚¹17,340</div>
                                        <div class="stat-label" data-zh="è´¦å•é‡‘é¢" data-en="Bills">è´¦å•é‡‘é¢</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- è®¾å¤‡ç»Ÿè®¡æ¨¡å— -->
                    <div class="table-container stats-module">
                        <div class="search-section">
                            <div class="search-controls">
                                <h3 data-zh="è®¾å¤‡çŠ¶æ€" data-en="Device Status">è®¾å¤‡çŠ¶æ€</h3>
                            </div>
                        </div>
                        <div class="device-stats">
                            <div class="device-chart-container">
                                <canvas id="deviceChart" width="150" height="150"></canvas>
                                <div class="device-summary">
                                    <div class="total-devices">
                                        <span class="total-number">15</span>
                                        <span class="total-label" data-zh="æ€»ç”µè¡¨" data-en="Total Meters">æ€»ç”µè¡¨</span>
                                    </div>
                                </div>
                            </div>
                            <div class="device-legend">
                                <div class="legend-item">
                                    <div class="legend-color online-color"></div>
                                    <div class="legend-text">
                                        <div class="legend-value">13</div>
                                        <div class="legend-label" data-zh="åœ¨çº¿" data-en="Online">åœ¨çº¿</div>
                                    </div>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color offline-color"></div>
                                    <div class="legend-text">
                                        <div class="legend-value">2</div>
                                        <div class="legend-label" data-zh="ç¦»çº¿" data-en="Offline">ç¦»çº¿</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </main>

    <script src="assets/js/common.js"></script>
    <script src="assets/js/navbar.js"></script>
    <script>
        // é¡µé¢ç‰¹å®šåˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // åˆå§‹åŒ–å·¥ä½œæµç¨‹çŠ¶æ€
            initWorkflowStatus();

            // åˆ›å»ºè®¾å¤‡é¥¼å›¾
            createDeviceChart();

            // ç›‘å¬è¯­è¨€å˜åŒ–
            window.addEventListener('languageChanged', () => {
                // è¯­è¨€å˜åŒ–æ—¶é‡æ–°æ¸²æŸ“å†…å®¹
                updateWorkflowUI();
            });
        });

        // å·¥ä½œæµç¨‹çŠ¶æ€ç®¡ç†
        let workflowProgress = {
            device: false,
            space: false,
            user: false,
            template: false
        };

        function initWorkflowStatus() {
            // ä»localStorageè·å–å·¥ä½œæµç¨‹çŠ¶æ€
            const savedProgress = localStorage.getItem('workflowProgress');
            if (savedProgress) {
                workflowProgress = JSON.parse(savedProgress);
            }
            updateWorkflowUI();
        }

        function updateWorkflowUI() {
            const steps = ['device', 'space', 'user', 'template'];
            let completedCount = 0;

            steps.forEach((step, index) => {
                const isCompleted = workflowProgress[step];
                const stepElement = document.querySelector(`[data-step="${index + 1}"]`);
                const buttonElement = stepElement.querySelector('.btn-primary');

                if (isCompleted) {
                    completedCount++;
                    stepElement.classList.add('completed');
                    if (buttonElement) {
                        const currentLang = getCurrentLanguage();
                        buttonElement.textContent = currentLang === 'zh' ? 'æŸ¥çœ‹è¯¦æƒ…' : 'View Details';
                    }
                } else {
                    stepElement.classList.remove('completed');
                }
            });

            // æ›´æ–°è¿›åº¦æ¡
            const progressPercent = (completedCount / steps.length) * 100;
            const progressBar = document.getElementById('workflow-progress');
            if (progressBar) {
                progressBar.style.width = progressPercent + '%';
            }

            // ä¿å­˜çŠ¶æ€
            localStorage.setItem('workflowProgress', JSON.stringify(workflowProgress));
        }

        // å·¥ä½œæµç¨‹æ“ä½œå‡½æ•°
        function startTemplate() {
            if (workflowProgress.template) {
                window.location.href = 'pricing-templates.html';
            } else {
                // æ˜¾ç¤ºå¼•å¯¼å¯¹è¯æ¡†
                showWorkflowDialog('template', {
                    title: 'åˆ›å»ºç”µä»·æ¨¡ç‰ˆ',
                    content: 'æ‚¨å°†è¢«å¼•å¯¼åˆ›å»ºä¸€ä¸ªæ–°çš„ç”µä»·æ¨¡ç‰ˆã€‚è¿™åŒ…æ‹¬è®¾ç½®è®¡è´¹æ–¹å¼ã€ç”µä»·ç»“æ„å’Œé™„åŠ è´¹ç”¨ã€‚',
                    action: () => {
                        window.location.href = 'pricing-designer.html';
                    }
                });
            }
        }

        function startSpace() {
            if (workflowProgress.space) {
                window.location.href = 'space-management.html';
            } else {
                showWorkflowDialog('space', {
                    title: 'åˆ›å»ºå»ºç­‘',
                    content: 'æ‚¨å°†åˆ›å»ºå»ºç­‘ç‰©å’Œæˆ¿é—´ç»“æ„ã€‚è¿™æœ‰åŠ©äºç»„ç»‡å’Œç®¡ç†æ‚¨çš„ç”µè¡¨è®¾å¤‡ã€‚',
                    action: () => {
                        window.location.href = 'space-management.html';
                    }
                });
            }
        }

        function startDevice() {
            if (workflowProgress.device) {
                window.location.href = 'device-management.html';
            } else {
                showWorkflowDialog('device', {
                    title: 'æ·»åŠ è®¾å¤‡',
                    content: 'æ‚¨å°†æ³¨å†Œç”µè¡¨è®¾å¤‡å¹¶å°†å…¶åˆ†é…åˆ°ç›¸åº”çš„ç©ºé—´ã€‚è¿™æ˜¯ç›‘æ§ç”¨ç”µé‡çš„åŸºç¡€ã€‚',
                    action: () => {
                        window.location.href = 'device-management.html';
                    }
                });
            }
        }

        function startUser() {
            if (workflowProgress.user) {
                window.location.href = 'user-management.html';
            } else {
                showWorkflowDialog('user', {
                    title: 'æ·»åŠ ç”¨æˆ·',
                    content: 'æ‚¨å°†åˆ›å»ºç”¨æˆ·è´¦æˆ·å¹¶å°†å…¶ä¸è®¾å¤‡ç»‘å®šã€‚ç”¨æˆ·å°†èƒ½å¤ŸæŸ¥çœ‹ä»–ä»¬çš„ç”µè´¹è´¦å•ã€‚',
                    action: () => {
                        window.location.href = 'user-management.html';
                    }
                });
            }
        }

        function showWorkflowDialog(type, options) {
            const dialog = document.createElement('div');
            dialog.className = 'workflow-dialog-overlay';
            dialog.innerHTML = `
                <div class="workflow-dialog">
                    <div class="dialog-header">
                        <h3>${options.title}</h3>
                        <button class="dialog-close" onclick="closeWorkflowDialog()">&times;</button>
                    </div>
                    <div class="dialog-content">
                        <p>${options.content}</p>
                    </div>
                    <div class="dialog-actions">
                        <button class="btn btn-secondary" onclick="closeWorkflowDialog()">å–æ¶ˆ</button>
                        <button class="btn btn-primary" onclick="executeWorkflowAction('${type}')">å¼€å§‹</button>
                    </div>
                </div>
            `;
            document.body.appendChild(dialog);
            dialog.workflowAction = options.action;
        }

        function closeWorkflowDialog() {
            const dialog = document.querySelector('.workflow-dialog-overlay');
            if (dialog) {
                document.body.removeChild(dialog);
            }
        }

        function executeWorkflowAction(type) {
            const dialog = document.querySelector('.workflow-dialog-overlay');
            if (dialog && dialog.workflowAction) {
                dialog.workflowAction();
            }
            closeWorkflowDialog();
        }

        // æ ‡è®°æ­¥éª¤å®Œæˆï¼ˆå¯ä»¥åœ¨å…¶ä»–é¡µé¢è°ƒç”¨ï¼‰
        function markStepCompleted(step) {
            workflowProgress[step] = true;
            updateWorkflowUI();
        }

        // é‡ç½®å·¥ä½œæµç¨‹
        function resetWorkflow() {
            if (confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰æµç¨‹è¿›åº¦å—ï¼Ÿè¿™å°†æ¸…é™¤æ‰€æœ‰å®ŒæˆçŠ¶æ€ã€‚')) {
                workflowProgress = {
                    device: false,
                    space: false,
                    user: false,
                    template: false
                };
                updateWorkflowUI();
            }
        }

        // å±•å¼€/æ”¶èµ·å·¥ä½œæµç¨‹æŒ‡å¼•
        function toggleWorkflowGuide() {
            const guide = document.getElementById('workflowGuide');
            const workflowSteps = document.getElementById('workflowSteps');
            const toggleBtn = guide.querySelector('.workflow-toggle-icon');
            const isCollapsed = workflowSteps.style.display === 'none';

            if (isCollapsed) {
                // å±•å¼€ï¼šæ˜¾ç¤ºæ­¥éª¤å†…å®¹
                workflowSteps.style.display = 'block';
                toggleBtn.classList.remove('collapsed');
                toggleBtn.title = 'æ”¶èµ·æŒ‡å¼•';
            } else {
                // æ”¶èµ·ï¼šéšè—æ­¥éª¤å†…å®¹
                workflowSteps.style.display = 'none';
                toggleBtn.classList.add('collapsed');
                toggleBtn.title = 'å±•å¼€æŒ‡å¼•';
            }
        }

        // åˆ›å»ºè®¾å¤‡é¥¼å›¾
        function createDeviceChart() {
            const canvas = document.getElementById('deviceChart');
            if (!canvas) return;

            const ctx = canvas.getContext('2d');
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = 60;

            // æ•°æ®
            const online = 13;
            const offline = 2;
            const total = online + offline;

            // è®¡ç®—è§’åº¦
            const onlineAngle = (online / total) * 2 * Math.PI;
            const offlineAngle = (offline / total) * 2 * Math.PI;

            // é¢œè‰²
            const onlineColor = '#48bb78'; // var(--success)
            const offlineColor = '#f56565'; // var(--error)

            // æ¸…é™¤ç”»å¸ƒ
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // ç»˜åˆ¶åœ¨çº¿éƒ¨åˆ†
            ctx.beginPath();
            ctx.moveTo(centerX, centerY);
            ctx.arc(centerX, centerY, radius, 0, onlineAngle);
            ctx.closePath();
            ctx.fillStyle = onlineColor;
            ctx.fill();

            // ç»˜åˆ¶ç¦»çº¿éƒ¨åˆ†
            ctx.beginPath();
            ctx.moveTo(centerX, centerY);
            ctx.arc(centerX, centerY, radius, onlineAngle, onlineAngle + offlineAngle);
            ctx.closePath();
            ctx.fillStyle = offlineColor;
            ctx.fill();

            // ç»˜åˆ¶ä¸­å¿ƒåœ†åœˆï¼ˆåˆ›å»ºç¯å½¢æ•ˆæœï¼‰
            ctx.beginPath();
            ctx.arc(centerX, centerY, 35, 0, 2 * Math.PI);
            ctx.fillStyle = '#ffffff';
            ctx.fill();
        }
    </script>
</body>
</html>